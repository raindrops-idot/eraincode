## 前言
之前在划水的时候无意中看见一篇很符合自己审美的博客，有种想荡下来的冲动，于是这个博客诞生了，前前后后经历了两个星期左右。期间百度各种博客搭建教程，最后根据自己实际情况选用markdown+jekyll+github的组合方式，新写的博客提交到github上后会自动发布。除此之外还有其它搭建博客的方法，小伙伴们可自行百度。这种方式搭建的博客属于静态网站，交互性不强，主要用于文档、图片、视频等静态信息的记录与展示。若有其它需要可以自己查找资料看看是否有插件可以支持，若没有插件，那就真的不支持。若硬要支持那就只能自己动手【手动狗头】。
## 工具及介绍
工具主要有Ruby、msys2、jiekyll、github pages，之间的关系如图。![](/jekyll.png)   
下面分别进行介绍。
#### Ruby[官网](http://www.ruby-lang.org/zh_cn/)    
Ruby是一种纯面向对象的编程语言。其它的可以百度或访问[官网](http://www.ruby-lang.org/zh_cn/)。搭建博客时用作本地预览的启动环境，jekyll属于ruby的包，类似于java的依赖包或者c的依赖库。使用时需要安装，其主要用作创建博项目，并将需要发布的静态博客内容打包转换成网页进行发布，可以在本地进行预览。在使用jekyll时还用到了bundle，它也是ruby的包，主要用作管理ruby各个包之间的依赖关系，类似于maven或者gradle。
#### MSYS2 [官网](https://www.msys2.org/)    
msys2可以理解为在windows上的一个linux环境，gem安装依赖时需要用到,否则安装依赖时会失败。
#### jekyll[官网](http://jekyllcn.com/)   
将静态文本转换成网页的工具，便于本地预览，远程发布。除此之外还可以选择自己喜欢的博客主题进行安装，想找博客主题推荐[jekyll themes](http://jekyllthemes.org/)
#### github-pages   
用于发布博客。jekyll只能进行本地预览，但外网无法访问，即只能独乐乐。通过github-pages可以将其发布到互联网上，同时github免费不需要自己购买服务器。

## 搭建流程
#### 安装工具   

- 安装Ruby和MSYS2      
为啥这俩货放一块讲呢，因为在Ruby安装完成后会提示安装MSYS2，有的小伙伴一看真方便，于是就点了，于是安装进度条就一直卡着不动。原因是ruby的gem默认使用的是国外源，于是你懂的。所以推荐Ruby和MSYS2分开安装，先安装MSYS2再安装Ruby。MSYS2安装完成后需要修改其软件源---在安装目录etc/pacman.d文件夹下找到mirrorlist开头的三个文件，分别打开找到清华镜像源，删除其它源，没找到则删除其它源并添加清华镜像源。Ruby安装到最后一步记得勾选ridk install，![](/jekyll-ruby-install.jpg)   
点击finsh后会弹出msys2的安装界面，输入3后回车。由于之前msys2已经安装好了，系统会自动检测剩余的依赖包进行安装或更新。最后记得给Ruby设置环境变量，将安装文件夹bin路径放到path下面就可以。![](/jekyll-1.jpg)
- 安装jekyll以及bundle    
使用gem进行安装，在安装前需要将gem源设置为国内源
```
# 移出国外源
gem sources --remove https://rubygems.org/
# 设置国内源
gem sources -a https://gems.ruby-china.com/
# 或者使用
gem sources -a https://gems.ruby-china.com/ --remove https://rubygems.org/
# 查看源
gem sources -l
# 安装jekyll、bundle
gem install jekyll
gem install bundle
```
在此先不安装其它依赖，待会使用bundle进行安装，方便管理依赖之间的关系

#### 创建博客
假设创建一个名为myblog的博客项目，操作如下
```
# 创建博客, 跳过bundle，因为创建完成后会执行bundle install安装默认的依赖，然而源仍然是国外的。问号头的小伙伴继续往下看
jekyll new myblog --skip-bundle
```
博客目录结构如下：
![](/jekyll-2.jpg)

Gemfile和_config.yml文件最为重要，前者声明了博客的gem源地址以及需要的插件和依赖包，后者声明博客的相关配置及全局变量。需根据自己的实际情况仔细阅读进行配置。由于在github上是使用github pages进行发布的，所以本地和远程配置有点不同。以下是我自己本地平常写博客时预览的配置，远程配置可以上[github](https://github.com/raindrops-idot/eraincode.git)查看。

- 本地Gemfile配置

```
# source "https://rubygems.org"
source "https://gems.ruby-china.com/"
# Hello! This is where you manage which Jekyll version is used to run.
# When you want to use a different version, change it below, save the
# file and run `bundle install`. Run Jekyll with `bundle exec`, like so:
#
#     bundle exec jekyll serve
#
# This will help ensure the proper Jekyll version is running.
# Happy Jekylling!
gem "jekyll", "~> 4.1.1"
gem "jekyll-theme-persephone"
# This is the default theme for new Jekyll sites. You may change this to anything you like.
# gem "minima", "~> 2.5"
# If you want to use GitHub Pages, remove the "gem "jekyll"" above and
# uncomment the line below. To upgrade, run `bundle update github-pages`.
# gem "github-pages", group: :jekyll_plugins
# If you have any plugins, put them here!
group :jekyll_plugins do
  gem "jekyll-feed", "~> 0.12"
  # gem "jekyll-remote-theme"
  gem "jekyll-paginate"
  gem "jekyll-toc"
end
# Windows and JRuby does not include zoneinfo files, so bundle the tzinfo-data gem
# and associated library.
platforms :mingw, :x64_mingw, :mswin, :jruby do
  gem "tzinfo", "~> 1.2"
  gem "tzinfo-data"
end
# Performance-booster for watching directories on Windows
# gem "wdm", "~> 0.1.1", :platforms => [:mingw, :x64_mingw, :mswin]
```

- 本地_config.yml配置

```
# title: Your Site Title
# description: The description of your site.
# email: your-email@address.com
title: 一叶知秋
email: 15517526173@163.com
description: 爱代码，更爱生活

# author: raindrops-idot #  Default is your site title.
author: 一叶知秋

# # Your social accounts.
# social:
#   github: github_username
#   twitter: twitter_username
#   facebook: facebook_username
#   instagram: instagram_username
#   linkedin: linkedin_username
#   weibo: weibo_username
social:
  github: raindrops-idot

# # Theme Settings

# # Your site's logo. Will be shown on the left top of your page.
# logo: /img/logo.svg
# logo: /icoder/images/logo.svg
logo: /images/logo.svg
# # If the images of our blog are stored in an external cloud. You can use the jekyll-img-prefix plugin and set your images' base URL here.
# img_prefix: https://your-img-cdn.com
# # The RSS link of your blog.
# rss: "/feed.xml"

# # The followings are settings for displays of your blog.
# theme_setting:
theme_setting:
#   # The slides count in the slides layout. Default is 4.
#   slides_count: 5
  slides_count: 5
#   # The ← back URL on the top of your post page. Default is your site's home page.
#   blog_page: "blog/index.md"
  blog_page: "index.md"
#   # The URL on your name on the bottom of your post and page. Default is your site's home page.
#   about_page: "about.md"
  about_page: "about.md"
#   #  The URL of the menu icon(which has three black lines). Will be shown on the slides/book/chapter layouts It won't be shown if blank.
#   archive_page: "archive.md"
  archive_page: "archive.md"
#   # The nav links on the top right of home/page/post/blog layout. You can set a local page(by setting a layout's path) or and external link ( both title and url are required) here.
#   nav_pages:
#     - "about.md"
#     -
#       title: "External Link Title"
#       url: "https://your-external-link.com"
  nav_pages: 
    - "index.md"
    - "about.md"
    - "archive.md"
#   # Every default value in the following settings is false. You can set them globally here or separately in a single post/page/chapter.
#   code: true # Code highlight.
  code: true
#   math: true # Mathjax
  math: true
#   mermaid: true # Mermaid
#   #  Locales of this theme.
#   lang:
#     category_all: All # The first tag in the categories bar on the blog layout page. By clicking it all of your posts will be shown. Default is 'All'.
#     blog_title: Blog # The text of ← back url on the top of the post layout.  Default is 'Home'.
  lang:
    category_all: 全部
    blog_title: 主页
#     # The locales of the comment controls.
#     comment:
#       user: "昵称"
#       email: "邮箱"
#       url: "链接"
#       message: "说点什么吧..."
#       reply: "回复"

# head_code: |
#   <!-- Extra codes in the head of your site pages. You can add your Google Analysis codes here! -->

# # The settings of comments.
# comment:
#   # You should set it to enable comment
#   enabled: true
#   # Your comment provider
#   provider: disqus # static/disqus
#   # If provider == disqus
#   disqus:
#     name: website_name
#   # Or provider == static
#   static:
#     # Your static comment url.
#     postUrl:  https://api.staticman.net/v2/connect/GITHUB-USERNAME/GITHUB-REPOSITORY
# # The settings of local smileys used in static comments. The jekyll-smiley plugin is required.
# smiley:
#   enabled: true
#   dir: img/smileys

#jekyll settings
markdown: kramdown
permalink: /blog/:title:output_ext
timezone: Asia/Shanghai
excerpt_separator: <!--more-->
defaults:
  -
    scope:
      path: ""
      type: "posts"
    values:
      layout: "post"
      toc: true



# Build settings
theme: jekyll-theme-persephone
# remote_theme: erlzhang/jekyll-theme-persephone
plugins:
  - jekyll-feed
  - jekyll-paginate
  - jekyll-toc
  # - jekyll-remote-theme

# Exclude from processing.
# The following items will not be processed, by default.
# Any item listed under the `exclude:` key here will be automatically added to
# the internal "default list".
#
# Excluded items can be processed by explicitly listing the directories or
# their entries' file path in the `include:` list.
#
# exclude:
#   - .sass-cache/
#   - .jekyll-cache/
#   - gemfiles/
#   - Gemfile
#   - Gemfile.lock
#   - node_modules/
#   - vendor/bundle/
#   - vendor/cache/
#   - vendor/gems/
#   - vendor/ruby/
```
配置好后使用命令`bundle install` 检测并安装依赖（gem安装时只安装软件不会安装相关依赖软件），`jekyll serve`启动服务器进行预览。最后访问`localhost:4000`即可进行预览，若显示依赖冲突则使用命令`bundle exec jekyll serve`进行启动。
#### 申请GitHub账号及创建仓库(业内人士请跳过此步骤)
#### 提交博客内容及发布    
 若本地未创建过仓库且未关联远程仓库，操作如下：
```
# 初始化本地仓库
git init
# 关联远程仓库
git remote set-url --add origin +远程仓库地址
# 接下来是提交博客
git commit -m 相关提交描述
git push
```
若本地关联过远程仓库则直接提交即可。需要注意的是本地预览和远程发布的Gemfile和_config.yml文件配置不同，记得修改
然后用浏览器登陆github找到对应仓库的settings
![](/jekyll-5.jpg)
然后一直往下拉找到github pages进行如图的配置
![](/jekyll-6.jpg)
设置完成后会显示发布地址，通过此地址可以访问发布完成的博客，之后只要编写博客放到_posts文件夹下并提交到github上，对应的博文会自动发布。
